# Release v0.2.9-alpha - 21 février 2026

## Mode : Fast-track (fix unique, 2 fichiers)

## Commits inclus (depuis v0.2.8-alpha)

| Commit | Type | Description |
|--------|------|-------------|
| `7cc0829` | fix | BUG-026 bouton Utiliser email - createPortal + z-index fix |
| `8d8b920` | chore | bump version 0.2.8 → 0.2.9 |

## Détail du fix

### BUG-026 (revisited) - Bouton "Utiliser" du générateur de réponse email

**Problème** : Après avoir généré un brouillon de réponse email via IA, le bouton "Utiliser" (qui doit ouvrir le compositeur avec le texte généré) ne faisait rien au clic.

**Cause racine** : Le `ResponseGeneratorModal` utilisait `position: fixed` à l'intérieur d'un arbre DOM où Framer Motion applique des `transform` sur les ancêtres. En CSS, un `transform` sur un ancêtre crée un nouveau containing block pour les éléments `position: fixed`, ce qui signifie que le modal était positionné relativement à l'email panel (pas au viewport). Combiné avec `overflow-hidden` et un `z-index` identique (z-50) entre le backdrop de l'email panel et le modal, les clics étaient interceptés.

**Fix** :
- `ResponseGeneratorModal.tsx` : rendu via `createPortal(... , document.body)` pour sortir le modal de l'arbre DOM parent
- z-index monté de `z-50` à `z-[60]` (au-dessus de l'email panel)
- `e.stopPropagation()` ajouté sur le bouton "Utiliser" pour empêcher le bubbling
- try/catch ajouté autour de `onUseResponse` pour capturer les erreurs silencieuses
- 4 tests de régression ajoutés

**Note** : Le fix BUG-026 de la PR #10 (v0.2.7) avait corrigé le cas où `message` était null dans `handleUseResponse`, mais n'avait pas résolu le problème CSS de stacking context qui empêchait les clics.

## Résumé technique

- **Version** : 0.2.8 → 0.2.9
- **Fichiers modifiés** : 2 fichiers (ResponseGeneratorModal.tsx, test_regression.py)
- **Tests régression** : 163 (159 → 163, +4 nouveaux)
- **Tests frontend** : 94/94 pass
- **Lint** : 0 erreur Ruff, 0 erreur TypeScript
- **CI** : verte

## Bugs connus non traités

- BUG-042 : Paramètres mail bloqués pendant streaming (Windows) - problème WebView2
- BUG-036 : Gmail OAuth redirect_uri_mismatch - action Ludo requise (Google Cloud Console)
- BUG-037 : Saut streaming résiduel - réduit mais pas éliminé
- BUG-027 : Compteur tokens faux (estimation len//4)

## Chronologie

- 21:28 - Diagnostic bouton Utiliser (lecture ResponseGeneratorModal, EmailDetail, EmailPanel, emailStore)
- 21:29 - Fix appliqué : createPortal + z-[60] + stopPropagation + try/catch
- 21:29 - TypeScript 0 erreur, 94/94 tests frontend, 163/163 tests régression
- 21:34 - Commit fix + bump version + tag v0.2.9-alpha poussé
- 21:34 - Build GitHub Actions lancé (macOS + Windows + Linux)
